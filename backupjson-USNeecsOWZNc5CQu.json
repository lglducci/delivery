{"createdAt":"2025-09-07T01:16:30.188Z","updatedAt":"2025-11-17T01:38:02.031Z","id":"USNeecsOWZNc5CQu","name":"backupJson","active":false,"isArchived":false,"nodes":[{"parameters":{},"id":"2ccba55e-c270-413b-bdb6-c0bf1e396264","name":"Execute workflow","type":"n8n-nodes-base.manualTrigger","typeVersion":1,"position":[-1632,432]},{"parameters":{"mode":"jsonToBinary","options":{"fileName":"={{ $json.name.replace(/\\s+/g, '-').toLowerCase() }}-{{ $json.id }}.json"}},"id":"9783ae25-8515-4fed-9eed-6cacca922c43","name":"Move JSON to binary","type":"n8n-nodes-base.moveBinaryData","typeVersion":1,"position":[-192,432]},{"parameters":{"content":"## Acionar\nVocê pode alterá-lo para [gatilho \"Agendar\"](https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.scheduletrigger/) para fazer backups regularmente.","height":380,"width":182},"id":"9e24aa67-9c1a-4f50-8543-484d3463d838","name":"Sticky Note","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-1664,224]},{"parameters":{"content":"## Definir e formatar data/hora\nEsses nós são responsáveis ​​por definir a data e hora atuais no formato `dd-MM-yyyy/H:mm`. Data e hora são usadas para compor mensagens de commit no GitHub, por exemplo: `backup-12-07-2023/14:18`.","height":379,"width":585},"id":"b06a7b8c-0bc7-43ad-8dc1-eaa274f8a6de","name":"Sticky Note1","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-1472,224]},{"parameters":{"content":"## Faça uma lista de arquivos existentes\nRetorne uma lista de arquivos existentes (backups) no repositório GitHub. Os dados retornados por esses nós são usados ​​pelo nó \"IF\" (posteriormente no fluxo de trabalho) para verificar se os arquivos de backup devem ser criados ou atualizados.","height":379,"width":390},"id":"0af4c0be-f7c8-4bac-9f97-341ce6def2d7","name":"Sticky Note2","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-864,224]},{"parameters":{"content":"## Recupere os workflows\nObtenha todos os fluxos de trabalho da sua instância n8n. Lembre-se de que **suas credenciais precisam apontar para a instância da qual você deseja fazer backup.**","height":379,"width":424},"id":"68a32383-3b63-44f2-925f-4810d6f2e590","name":"Sticky Note3","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-448,224]},{"parameters":{"content":"## Carregar cópia de segurança\nDivida os arquivos JSON em lotes de 1, verifique se eles foram carregados no repositório antes. Se sim (true), carregue a nova versão do arquivo. Caso contrário (false) crie o arquivo no repositório.","height":731.633426614796,"width":703.8733020263451},"id":"7663ab1d-6210-4578-8426-a04346efecd9","name":"Sticky Note4","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[0,0]},{"parameters":{"content":"## ⚠️ Aviso\n\n1. Automação inspirada do Canal do Oskar > [Canal dele no YouTube](https://www.youtube.com/watch?v=dNuVuoPD0Jo). \n","height":135,"width":509},"id":"9fad4e2e-0e84-4620-beac-e4cd4e961629","name":"Sticky Note5","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-1664,64]},{"parameters":{"authentication":"oAuth2","resource":"file","operation":"list","owner":{"__rl":true,"value":"https://github.com/lglducci/delivery","mode":"url"},"repository":{"__rl":true,"value":"delivery","mode":"list","cachedResultName":"delivery","cachedResultUrl":"https://github.com/lglducci/delivery"},"filePath":"="},"id":"45e58974-843f-4ab9-80a5-2ba8acaf973c","name":"Liste o Arquivos do Repositorio [GITHUB]","type":"n8n-nodes-base.github","typeVersion":1,"position":[-832,432],"alwaysOutputData":true,"webhookId":"c2f89c22-8c7c-4ba4-bf78-4d8ce405fe8b","credentials":{"githubOAuth2Api":{"id":"RGY801VyYmjoGnIP","name":"GitHub account 2"}}},{"parameters":{"operation":"aggregateItems","fieldsToAggregate":{"fieldToAggregate":[{"fieldToAggregate":"name"}]},"options":{}},"id":"7a5c1550-4df9-41e7-8ae6-0cc3c8e4fe15","name":"Combine os nomes do Arquivos [GITHUB]","type":"n8n-nodes-base.itemLists","typeVersion":2.1,"position":[-624,432]},{"parameters":{"keepOnlySet":true,"values":{"string":[{"name":"commitDate","value":"={{ $json.formattedDate }}"}]},"options":{}},"id":"898d4501-847e-4436-93b2-ed3f2b4a7a2a","name":"Setar a data do Commit","type":"n8n-nodes-base.set","typeVersion":2,"position":[-1024,432]},{"parameters":{"conditions":{"string":[{"value1":"={{ $node['Combine os nomes do Arquivos [GITHUB]'].json.name }}","operation":"contains","value2":"={{ $binary.data.fileName }}"}]}},"id":"95ebcca5-28b0-47b1-aefd-8081ad8d44d4","name":"Cheque se existem arquivos no Repositorio","type":"n8n-nodes-base.if","typeVersion":1,"position":[288,384]},{"parameters":{"options":{}},"id":"b44b2bc6-c8a8-4dd1-b1c3-19b6de8a499b","name":"Sete a data","type":"n8n-nodes-base.dateTime","typeVersion":2,"position":[-1424,432]},{"parameters":{"operation":"formatDate","date":"={{ $json.currentDate }}","format":"custom","customFormat":"dd-MM-yyyy/H:mm","options":{}},"id":"a452f558-170d-4bad-898e-6bbb8338fb99","name":"Data formatada","type":"n8n-nodes-base.dateTime","typeVersion":2,"position":[-1232,432]},{"parameters":{"batchSize":1,"options":{}},"id":"d0751a35-0953-4dc6-befc-e5801f70a6eb","name":"Dividindo em Arquivos Únicos","type":"n8n-nodes-base.splitInBatches","typeVersion":2,"position":[48,432]},{"parameters":{"filters":{},"requestOptions":{}},"id":"90e569ab-3cf0-4283-af54-fe9abfefe583","name":"Recupere os workflows [N8N]","type":"n8n-nodes-base.n8n","typeVersion":1,"position":[-384,432],"credentials":{"n8nApi":{"id":"M7mqQio9RpWc0qxf","name":"n8n account"}}},{"parameters":{"authentication":"oAuth2","resource":"file","operation":"edit","owner":{"__rl":true,"value":"https://github.com/lglducci/delivery","mode":"url"},"repository":{"__rl":true,"value":"delivery","mode":"list","cachedResultName":"delivery","cachedResultUrl":"https://github.com/lglducci/delivery"},"filePath":"={{ $binary.data.fileName }}","binaryData":true,"commitMessage":"=backup-{{ $node['Setar a data do Commit'].json.commitDate }}"},"id":"a93ee65b-3dac-41b8-91d7-57b211c79967","name":"Atualiza Arquivos [GITHUB]","type":"n8n-nodes-base.github","typeVersion":1,"position":[496,80],"webhookId":"c16b683e-afdd-4fd4-847c-2555eaafcace","credentials":{"githubOAuth2Api":{"id":"RGY801VyYmjoGnIP","name":"GitHub account 2"}}},{"parameters":{"authentication":"oAuth2","resource":"file","owner":{"__rl":true,"value":"https://github.com/lglducci/delivery","mode":"url"},"repository":{"__rl":true,"value":"delivery","mode":"list","cachedResultName":"delivery","cachedResultUrl":"https://github.com/lglducci/delivery"},"filePath":"={{ $binary.data.fileName }}","binaryData":true,"commitMessage":"=backup-{{ $node['Setar a data do Commit'].json.commitDate }}"},"id":"326e360e-4c9f-49ec-9e0d-7726d09639bd","name":"Atualiza arquivos [GITHUB]","type":"n8n-nodes-base.github","typeVersion":1,"position":[512,544],"webhookId":"080651e1-b61e-468b-abbd-e579b52f8efa","credentials":{"githubOAuth2Api":{"id":"RGY801VyYmjoGnIP","name":"GitHub account 2"}}}],"connections":{"Execute workflow":{"main":[[{"node":"Sete a data","type":"main","index":0}]]},"Move JSON to binary":{"main":[[{"node":"Dividindo em Arquivos Únicos","type":"main","index":0}]]},"Liste o Arquivos do Repositorio [GITHUB]":{"main":[[{"node":"Combine os nomes do Arquivos [GITHUB]","type":"main","index":0}]]},"Combine os nomes do Arquivos [GITHUB]":{"main":[[{"node":"Recupere os workflows [N8N]","type":"main","index":0}]]},"Setar a data do Commit":{"main":[[{"node":"Liste o Arquivos do Repositorio [GITHUB]","type":"main","index":0}]]},"Cheque se existem arquivos no Repositorio":{"main":[[{"node":"Atualiza Arquivos [GITHUB]","type":"main","index":0}],[{"node":"Atualiza arquivos [GITHUB]","type":"main","index":0}]]},"Sete a data":{"main":[[{"node":"Data formatada","type":"main","index":0}]]},"Data formatada":{"main":[[{"node":"Setar a data do Commit","type":"main","index":0}]]},"Dividindo em Arquivos Únicos":{"main":[[{"node":"Cheque se existem arquivos no Repositorio","type":"main","index":0}]]},"Recupere os workflows [N8N]":{"main":[[{"node":"Move JSON to binary","type":"main","index":0}]]},"Atualiza Arquivos [GITHUB]":{"main":[[{"node":"Dividindo em Arquivos Únicos","type":"main","index":0}]]},"Atualiza arquivos [GITHUB]":{"main":[[{"node":"Dividindo em Arquivos Únicos","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"aa2b02e6-10a3-4fea-a21c-2fab1e6edc5c","triggerCount":0,"shared":[{"createdAt":"2025-09-07T01:16:30.188Z","updatedAt":"2025-09-07T01:16:30.188Z","role":"workflow:owner","workflowId":"USNeecsOWZNc5CQu","projectId":"wFRMrac2003Pl1x6"}],"tags":[{"createdAt":"2025-09-07T00:48:06.709Z","updatedAt":"2025-09-07T00:48:06.709Z","id":"oyXqUAJNw26h8Z5c","name":"github"}]}