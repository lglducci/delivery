{"createdAt":"2025-11-15T23:46:05.246Z","updatedAt":"2025-11-16T02:07:36.858Z","id":"RKp4UbRWTvSLc7vh","name":"SiteFinanceFlow","active":false,"isArchived":false,"nodes":[{"parameters":{"respondWith":"allIncomingItems","options":{"responseCode":200}},"type":"n8n-nodes-base.respondToWebhook","typeVersion":1.4,"position":[-96,-288],"id":"d9ad8547-8ecc-4db7-8acd-b0c4b699cd92","name":"Respond to Webhook1"},{"parameters":{"operation":"executeQuery","query":"   select * from transacoes where empresa_id = {{ $json.id_empresa }};","options":{}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[-288,-288],"id":"e0657357-97c5-429d-999b-46d94bca3c9b","name":"GetPedido","alwaysOutputData":true,"credentials":{"postgres":{"id":"zC1myfhKaFbD3WiM","name":"FinanceFlow"}}},{"parameters":{"assignments":{"assignments":[{"id":"4616a119-9b3f-4dcd-b548-0be8d5f7a3b4","name":"id_empresa","value":"={{ $json.query.id_empresa}}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-496,-288],"id":"a92f529c-eb04-414c-bda6-a7931373f203","name":"Edit Fields1"},{"parameters":{"respondWith":"allIncomingItems","options":{"responseCode":200}},"type":"n8n-nodes-base.respondToWebhook","typeVersion":1.4,"position":[624,48],"id":"32dc8b19-b24e-4f33-9b95-c3b88fefab7e","name":"Respond to Webhook"},{"parameters":{"operation":"executeQuery","query":"   select * from transacoes where empresa_id = {{ $json.id_empresa }};","options":{}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[-816,-560],"id":"d56400b9-666a-4666-a56e-da4cb6c32d70","name":"GetPedido1","alwaysOutputData":true,"credentials":{"postgres":{"id":"zC1myfhKaFbD3WiM","name":"FinanceFlow"}}},{"parameters":{"assignments":{"assignments":[{"id":"4616a119-9b3f-4dcd-b548-0be8d5f7a3b4","name":"id_empresa","value":"=1","type":"string"},{"id":"03e9c46a-0444-41d9-97af-93245605fe79","name":"tipo","value":"=despesa","type":"string"},{"id":"a60a91bf-26b8-4a5e-89f3-9b9a88261afe","name":"conta","value":"Santander","type":"string"},{"id":"089dd36c-f804-400a-9ad4-6bdb0e824caf","name":"categoria","value":"compras","type":"string"},{"id":"d1d7d5e0-4756-4001-a87b-b026c482568e","name":"valor","value":"100","type":"string"},{"id":"99d8e470-89a7-4ca9-851d-e660846a6f8f","name":"descricao","value":"100 reais no posto do carlin","type":"string"},{"id":"1785aef6-9777-492f-a1c4-bbf34872bd03","name":"data","value":"2025-11-25","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-512,48],"id":"3b8f0440-487a-47ef-a8b0-cebbbb5ddb49","name":"Edit Fields"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"f1dd2b61-d8dc-477c-97e5-0eda8863c8e6","leftValue":"={{ $json.tipo }}","rightValue":"despesa","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[-304,48],"id":"8769bafd-58e4-4f91-a2ca-a1ca8a19236d","name":"If"},{"parameters":{},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[240,48],"id":"beffa411-dc78-4469-9a4b-4f3339f87331","name":"Merge"},{"parameters":{"assignments":{"assignments":[{"id":"4616a119-9b3f-4dcd-b548-0be8d5f7a3b4","name":"id_empresa","value":"={{ $json.query.id_empresa}}","type":"string"},{"id":"03e9c46a-0444-41d9-97af-93245605fe79","name":"tipo","value":"={{ $json.query.tipo}}","type":"string"},{"id":"a60a91bf-26b8-4a5e-89f3-9b9a88261afe","name":"conta","value":"","type":"string"},{"id":"089dd36c-f804-400a-9ad4-6bdb0e824caf","name":"categoria","value":"","type":"string"},{"id":"d1d7d5e0-4756-4001-a87b-b026c482568e","name":"valor","value":"","type":"string"},{"id":"99d8e470-89a7-4ca9-851d-e660846a6f8f","name":"descricao","value":"","type":"string"},{"id":"1785aef6-9777-492f-a1c4-bbf34872bd03","name":"data","value":"","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-1232,-448],"id":"77582664-a6ff-45dd-a219-4ed2d77803f3","name":"Edit Fields2"},{"parameters":{"respondWith":"allIncomingItems","options":{"responseCode":200}},"type":"n8n-nodes-base.respondToWebhook","typeVersion":1.4,"position":[560,464],"id":"e7d022c5-7cb6-43af-8f1b-4f56629b3049","name":"Respond to Webhook2"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"f1dd2b61-d8dc-477c-97e5-0eda8863c8e6","leftValue":"={{ $json.tipo }}","rightValue":"pagar","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[-304,464],"id":"a42e1969-b70a-452a-894d-691a7a4c67f8","name":"If1"},{"parameters":{},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[368,464],"id":"214a9e3c-cf7c-4281-9eda-59dee7355f08","name":"Merge1"},{"parameters":{"path":"listalancamentos","responseMode":"responseNode","options":{}},"type":"n8n-nodes-base.webhook","typeVersion":2.1,"position":[-752,-288],"id":"13d836d2-94e8-4438-911c-3fbec7b5511e","name":"Lancamento","webhookId":"77c2764f-3d24-48db-aef2-07b64e9ecdeb"},{"parameters":{"path":"novolancamento","responseMode":"responseNode","options":{}},"type":"n8n-nodes-base.webhook","typeVersion":2.1,"position":[-720,48],"id":"2b14b5f6-02e4-4a87-8da1-b85cff46a1b9","name":"NovoLancamento","webhookId":"77c2764f-3d24-48db-aef2-07b64e9ecdeb"},{"parameters":{"operation":"executeQuery","query":"  select * from ff_registrar_despesa(\n   {{ $json.id_empresa }} ,\n  '{{ $json.conta }}',\n   '{{ $json.categoria }}',\n    {{ $json.valor }},\n  '{{ $json.descricao }}'\n  ,'{{ $json.data }}' \n   \n)","options":{}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[-48,-32],"id":"8d2e4607-0fc1-49da-976d-784783a7afc6","name":"registrar_despesa","credentials":{"postgres":{"id":"zC1myfhKaFbD3WiM","name":"FinanceFlow"}}},{"parameters":{"operation":"executeQuery","query":"  select * from ff_registrar_receita(\n  {{ $json.id_empresa }} ,\n  '{{ $json.conta }}',\n   '{{ $json.categoria }}',\n    {{ $json.valor }},\n  '{{ $json.descricao }}'\n  ,'{{ $json.data }}' \n   \n)","options":{}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[-48,160],"id":"a1b3f791-bb7c-412c-a8a0-866175b8ee0a","name":"registrar_receita","credentials":{"postgres":{"id":"zC1myfhKaFbD3WiM","name":"FinanceFlow"}}},{"parameters":{"operation":"executeQuery","query":"select * from transacoes where empresa_id =  {{ $('Edit Fields').item.json.id_empresa }} and id = {{ $json.ff_registrar_despesa }}","options":{}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[400,48],"id":"df34d3f5-b471-4ce2-a188-ae24f7a03265","name":"BuscaTransacao","credentials":{"postgres":{"id":"zC1myfhKaFbD3WiM","name":"FinanceFlow"}}},{"parameters":{"assignments":{"assignments":[{"id":"4616a119-9b3f-4dcd-b548-0be8d5f7a3b4","name":"id_empresa","value":"=1","type":"string"},{"id":"03e9c46a-0444-41d9-97af-93245605fe79","name":"tipo","value":"=despesa","type":"string"},{"id":"a60a91bf-26b8-4a5e-89f3-9b9a88261afe","name":"conta","value":"Santander","type":"string"},{"id":"089dd36c-f804-400a-9ad4-6bdb0e824caf","name":"categoria","value":"compras","type":"string"},{"id":"d1d7d5e0-4756-4001-a87b-b026c482568e","name":"valor","value":"100","type":"string"},{"id":"99d8e470-89a7-4ca9-851d-e660846a6f8f","name":"descricao","value":"100 reais no posto do carlin","type":"string"},{"id":"1785aef6-9777-492f-a1c4-bbf34872bd03","name":"data","value":"2025-11-25","type":"string"},{"id":"a706eff1-8257-48c5-9349-ac2dd823e256","name":"parcela","value":"1","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-512,464],"id":"00ddbd88-ba1b-4ca0-aa66-5ddd28511937","name":"EditPagarReceber"},{"parameters":{"operation":"executeQuery","query":" select * from   ff_registrar_conta_pagar(\n   {{ $('EditPagarReceber').item.json.id_empresa }},\n  '{{ $('EditPagarReceber').item.json.descricao }}',\n    {{ $('EditPagarReceber').item.json.valor }},\n  '{{ $('EditPagarReceber').item.json.data }}',\n  '{{ $('EditPagarReceber').item.json.categoria }}', \n   {{ $('EditPagarReceber').item.json.parcela }}\n)\n","options":{}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[-80,384],"id":"b82508a5-ead8-481b-94a2-e54c5668f930","name":"registrar_conta_pagar","credentials":{"postgres":{"id":"zC1myfhKaFbD3WiM","name":"FinanceFlow"}}},{"parameters":{"operation":"executeQuery","query":" select * from   ff_registrar_conta_receber(\n  {{ $json.id_empresa }},\n  '{{ $json.descricao }}',\n    {{ $json.valor }},\n  '{{ $json.data }}',\n  '{{ $json.categoria }}',\n   '{{ $json.data }}' \n)\n\n\n","options":{}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[-80,576],"id":"29784a39-514d-49f7-91a2-3b70471e14e2","name":"registrar_conta_receber","credentials":{"postgres":{"id":"zC1myfhKaFbD3WiM","name":"FinanceFlow"}}},{"parameters":{"operation":"executeQuery","query":"select * from contas_a_pagar where empresa_id =   {{ $('EditPagarReceber').item.json.id_empresa }} and id ={{ $json.ff_registrar_conta_pagar }}  ;","options":{}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[112,384],"id":"7e5f7068-7f04-4896-871a-888e74593906","name":"conta_a_pagar","credentials":{"postgres":{"id":"zC1myfhKaFbD3WiM","name":"FinanceFlow"}}},{"parameters":{"operation":"executeQuery","query":" select * from contas_a_receber where empresa_id =   {{ $('EditPagarReceber').item.json.id_empresa }} and id = {{ $json.ff_registrar_conta_receber }};","options":{}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[128,576],"id":"c7e21dcc-90eb-4aac-95dd-d459b515bd09","name":"conta_a_receber","credentials":{"postgres":{"id":"zC1myfhKaFbD3WiM","name":"FinanceFlow"}}},{"parameters":{"path":"novopagarreceber","responseMode":"responseNode","options":{}},"type":"n8n-nodes-base.webhook","typeVersion":2.1,"position":[-720,464],"id":"b0cf6428-d2c7-41b6-b0dc-0304c123d4e6","name":"novopagarreceber","webhookId":"77c2764f-3d24-48db-aef2-07b64e9ecdeb"}],"connections":{"GetPedido":{"main":[[{"node":"Respond to Webhook1","type":"main","index":0}]]},"Edit Fields1":{"main":[[{"node":"GetPedido","type":"main","index":0}]]},"GetPedido1":{"main":[[]]},"Edit Fields":{"main":[[{"node":"If","type":"main","index":0}]]},"If":{"main":[[{"node":"registrar_despesa","type":"main","index":0}],[{"node":"registrar_receita","type":"main","index":0}]]},"Merge":{"main":[[{"node":"BuscaTransacao","type":"main","index":0}]]},"If1":{"main":[[{"node":"registrar_conta_pagar","type":"main","index":0}],[{"node":"registrar_conta_receber","type":"main","index":0}]]},"Merge1":{"main":[[{"node":"Respond to Webhook2","type":"main","index":0}]]},"Lancamento":{"main":[[{"node":"Edit Fields1","type":"main","index":0}]]},"NovoLancamento":{"main":[[{"node":"Edit Fields","type":"main","index":0}]]},"registrar_despesa":{"main":[[{"node":"Merge","type":"main","index":0}]]},"registrar_receita":{"main":[[{"node":"Merge","type":"main","index":1}]]},"BuscaTransacao":{"main":[[{"node":"Respond to Webhook","type":"main","index":0}]]},"EditPagarReceber":{"main":[[{"node":"If1","type":"main","index":0}]]},"registrar_conta_pagar":{"main":[[{"node":"conta_a_pagar","type":"main","index":0}]]},"registrar_conta_receber":{"main":[[{"node":"conta_a_receber","type":"main","index":0}]]},"conta_a_pagar":{"main":[[{"node":"Merge1","type":"main","index":0}]]},"conta_a_receber":{"main":[[{"node":"Merge1","type":"main","index":1}]]},"novopagarreceber":{"main":[[{"node":"EditPagarReceber","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"bde8c180-3555-4298-bb94-872c372b085d","triggerCount":0,"shared":[{"createdAt":"2025-11-15T23:46:05.246Z","updatedAt":"2025-11-15T23:46:05.246Z","role":"workflow:owner","workflowId":"RKp4UbRWTvSLc7vh","projectId":"wFRMrac2003Pl1x6"}],"tags":[]}