{"createdAt":"2025-09-18T15:44:58.320Z","updatedAt":"2025-09-20T01:35:04.962Z","id":"gL1FbKkYm9zGfCAA","name":"teste final fluxo reduzido pizzaria","active":false,"isArchived":false,"nodes":[{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.chatTrigger","typeVersion":1.3,"position":[-528,-528],"id":"1ea74531-5006-4059-bc21-c31f29416ee7","name":"When chat message received","webhookId":"d8fabc58-bc32-4374-9024-6ddf8884d885"},{"parameters":{"model":{"__rl":true,"value":"gpt-4.1-mini","mode":"list","cachedResultName":"gpt-4.1-mini"},"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[-2192,400],"id":"6620ad36-2344-4bad-b89a-7c87430656a9","name":"OpenAI Chat Model4","credentials":{"openAiApi":{"id":"YvUoOPijIpNeTjed","name":"OpenAi account"}}},{"parameters":{"schemaType":"manual","inputSchema":" {\n  \"type\": \"object\",\n  \"properties\": {\n    \"item\": {\n      \"type\": \"array\",\n      \"items\": {\n        \"type\": \"object\",\n        \"additionalProperties\": false,\n        \"properties\": {\n          \"numero\": { \"type\": \"integer\", \"minimum\": 0 },\n          \"quantidade\": { \"type\": \"integer\", \"minimum\": 1 },\n          \"tamanho\": { \"type\": \"string\" },\n          \"fracionada\": { \"type\": \"string\", \"enum\": [\"sim\", \"nao\", \"\"] },\n          \"tipo\": { \"type\": \"string\", \"enum\": [\"inteira\", \"fracionada\", \"\"] },\n          \"categoria\": { \"type\": \"string\", \"enum\": [\"pizza\", \"esfirra\", \"bebida\", \"borda\"] },\n          \"numero_fracao\": { \"type\": \"integer\", \"minimum\": 0 },\n          \"nome\": { \"type\": \"string\" },\n          \"nome_fracao\": { \"type\": \"string\" },\n          \"volume\": { \"type\": \"string\" },\n          \"valor\": { \"type\": \"number\", \"minimum\": 0 },\n          \"pizza_referencia\": { \"type\": \"string\" },\n          \"id_pizza_pai\": { \"type\": \"integer\", \"minimum\": 0 }\n        },\n        \"required\": [\n          \"numero\",\n          \"quantidade\",\n          \"tamanho\",\n          \"fracionada\",\n          \"tipo\",\n          \"categoria\",\n          \"numero_fracao\",\n          \"nome\",\n          \"nome_fracao\",\n          \"volume\",\n          \"valor\",\n          \"pizza_referencia\",\n          \"id_pizza_pai\"\n        ]\n      }\n    },\n    \"pizzas_fracionadas\": {\n      \"type\": \"array\",\n      \"items\": {\n        \"type\": \"object\",\n        \"additionalProperties\": false,\n        \"properties\": {\n          \"numero\": { \"type\": \"integer\", \"minimum\": 0 },\n          \"quantidade\": { \"type\": \"integer\", \"minimum\": 1 },\n          \"tamanho\": { \"type\": \"string\" },\n          \"fracionada\": { \"type\": \"string\", \"enum\": [\"sim\", \"nao\", \"\"] },\n          \"tipo\": { \"type\": \"string\", \"enum\": [\"fracionada\", \"\"] },\n          \"categoria\": { \"type\": \"string\", \"enum\": [\"pizza\"] },\n          \"metade1\": { \"type\": \"string\" },\n          \"metade2\": { \"type\": \"string\" },\n          \"valor\": { \"type\": \"number\", \"minimum\": 0 },\n          \"pizza_referencia\": { \"type\": \"string\" },\n          \"id_pizza_pai\": { \"type\": \"integer\", \"minimum\": 0 }\n        },\n        \"required\": [\n          \"numero\",\n          \"quantidade\",\n          \"tamanho\",\n          \"fracionada\",\n          \"tipo\",\n          \"categoria\",\n          \"metade1\",\n          \"metade2\",\n          \"valor\",\n          \"pizza_referencia\",\n          \"id_pizza_pai\"\n        ]\n      }\n    }\n  },\n  \"required\": [\"item\", \"pizzas_fracionadas\"],\n  \"additionalProperties\": false\n}\n"},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.2,"position":[-2048,416],"id":"caf8ea8c-da06-4f25-8289-6eeda32a8618","name":"Structured Output Parser [Schema]1","notes":"TEMPLATE DESENVOLVIDO POR NOCODE STARTUP\nhttps://nocodestartup.io/\n\nFORMA√á√ÉO GESTOR DE AGENTES DE IA:\nhttps://nocodestartup.io/formacao-gestor-agentes-ia/"},{"parameters":{"promptType":"define","text":"=<mensagem_do_usuario>\n{{ $json.chatInput }}\n</mensagem_do_usuario>","hasOutputParser":true,"messages":{"messageValues":[{"message":"= Voc√™ √© um parser de pedidos de pizzaria.  \nSua √∫nica sa√≠da deve ser um JSON v√°lido que siga exatamente o schema configurado (structured output).  \n\n‚ö†Ô∏è Regras obrigat√≥rias:  \n- Sempre responda APENAS com o JSON (sem texto, sem explica√ß√µes, sem blocos de c√≥digo).  \n- Sempre retorne os dois blocos: \"item\" e \"pizzas_fracionadas\", mesmo que vazios.  \n- Preencha todos os campos com defaults quando n√£o houver informa√ß√£o.  \n- Nunca invente valores fora do permitido.  \n- Nunca omita campos obrigat√≥rios.\n\nüìå Defaults:  \n- quantidade = 1  \n- tamanho = \"media\" (para pizzas/esfirras), sen√£o vazio \"\"  \n- fracionada = \"nao\"  \n- tipo = \"inteira\" (ou \"fracionada\" no caso de pizza fracionada)  \n- numero = 0, numero_fracao = 0  \n- nome, nome_fracao, volume, pizza_referencia = \"\"  \n- valor = 0  \n- id_pizza_pai = 0  \n- categoria ‚àà {\"pizza\",\"esfirra\",\"bebida\",\"borda\"}  \n\nüìå Regras de interpreta√ß√£o:  \n- S√≥ trate como \"pizza\" se a palavra \"pizza\" aparecer; idem para \"esfirra\".  \n- A palavra \"uma\", \"duas\", \"tr√™s\" etc sempre define a quantidade.  \n- \"meia\" ‚â° \"1/2\".  \n- \"pizza N\" (sem sabor) ‚Üí {quantidade:1, numero:N, tamanho:\"media\", categoria:\"pizza\"}.  \n\nüìå Pizzas fracionadas:  \n- Sempre um √∫nico objeto dentro de \"pizzas_fracionadas\".  \n- Use {metade1, metade2} para os dois sabores/n√∫meros.  \n- Marque fracionada=\"sim\", tipo=\"fracionada\".  \n- Use uma pizza_referencia (ex.: \"ref_123\") para vincular bordas a ela.  \n\nüìå Bordas:  \n- Se houver \"borda X\", categoria=\"borda\", nome=\"x\".  \n- Sempre vincular via pizza_referencia ou id_pizza_pai.  \n- Defaults: numero=0, tamanho=\"\", valor=0.  \n\nüìå Bebidas:  \n- \"lata\" sem volume ‚Üí \"350ml\".  \n- \"long neck\" sem volume ‚Üí \"330ml\".  \n- \"coca/coca-cola\" sem volume ‚Üí \"2l\".  \n- Normalize sempre min√∫sculo, sem espa√ßos (ex.: \"350ml\", \"2l\").  \n\nüìå Esfirras:  \n- Sempre categoria=\"esfirra\", tipo=\"salgada\" ou \"doce\".  \n\nüìå Resultado esperado:  \n- Itens simples (pizza inteira, bebida, esfirra, borda) ‚Üí em \"item\".  \n- Itens fracionados ‚Üí em \"pizzas_fracionadas\".  \n"}]}},"type":"@n8n/n8n-nodes-langchain.chainLlm","typeVersion":1.6,"position":[-2192,224],"id":"47ba66be-2a84-41c8-b47e-773f02dac045","name":"Basic LLM Chain1","retryOnFail":true,"notes":"TEMPLATE DESENVOLVIDO POR NOCODE STARTUP\nhttps://nocodestartup.io/\n\nFORMA√á√ÉO GESTOR DE AGENTES DE IA:\nhttps://nocodestartup.io/formacao-gestor-agentes-ia/"},{"parameters":{"fieldToSplitOut":"output.item","options":{}},"type":"n8n-nodes-base.splitOut","typeVersion":1,"position":[-1872,224],"id":"0573e840-dbdc-45d6-8ba0-22260df6030a","name":"item","notes":"TEMPLATE DESENVOLVIDO POR NOCODE STARTUP\nhttps://nocodestartup.io/\n\nFORMA√á√ÉO GESTOR DE AGENTES DE IA:\nhttps://nocodestartup.io/formacao-gestor-agentes-ia/"},{"parameters":{"options":{}},"type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[-1648,192],"id":"74402ae8-670e-429a-8aee-3b808ea1fb84","name":"Loop Over Items"},{"parameters":{},"type":"n8n-nodes-base.noOp","name":"Replace Me","typeVersion":1,"position":[-1456,48],"id":"b9cae534-725c-4f0d-9119-662bed4b26df"},{"parameters":{"tableId":"item_pedido_temp","fieldsUi":{"fieldValues":[{"fieldId":"user_id","fieldValue":"71"},{"fieldId":"quantidade","fieldValue":"=1"},{"fieldId":"tipo","fieldValue":"salgado"},{"fieldId":"categoria","fieldValue":"item"},{"fieldId":"nome","fieldValue":"= {{ $('Loop Over Items').item.json.nome }}"},{"fieldId":"fracionada","fieldValue":"=false"},{"fieldId":"pedido_id","fieldValue":"=15"},{"fieldId":"tamanho","fieldValue":"=grande"},{"fieldId":"volume","fieldValue":"=''"}]}},"type":"n8n-nodes-base.supabase","typeVersion":1,"position":[-944,176],"id":"f8dfa431-04ab-49a3-b02f-0cf2a7237059","name":"Item","credentials":{"supabaseApi":{"id":"CcvRddDPb5xelxfb","name":"Supabase account"}}},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"9f620984-016b-4b6b-bd32-a5be81b30118","leftValue":"={{ $items().length }}","rightValue":1,"operator":{"type":"number","operation":"equals"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[-1216,192],"id":"3363db2a-d845-4639-8e46-be6322c68826","name":"If"},{"parameters":{"operation":"executeQuery","query":" SELECT\n    numero,\n    nome,\n    descricao,\n    tipo,\n    cardapio,\n    CASE \n        WHEN '{{ $json.tamanho }}' = 'grande' THEN preco_grande\n        WHEN '{{ $json.tamanho }}' = 'media'  THEN preco_media\n        ELSE preco_grande\n    END AS valor\nFROM busca_cardapio((\n    SELECT string_agg(num, ', ')\n    FROM (\n        SELECT DISTINCT c.numero::text AS num\n        FROM cardapio AS c\n        WHERE c.nome ILIKE '%' || '{{ $json.nome }}' || '%'\n          AND categoria = '{{ $json.categoria }}' and  categoria not in ( 'borda','item')\n    )\n))\n  union all \n SELECT\n    numero,\n    nome,\n    descricao,\n    tipo,\n    cardapio,\n    CASE \n        WHEN '{{ $json.tamanho }}' = 'grande' THEN preco_grande\n        WHEN '{{ $json.tamanho }}' = 'media'  THEN preco_media\n        ELSE preco_grande\n    END AS valor\nFROM busca_cardapio((\n    SELECT string_agg(num, ', ')\n    FROM (\n        SELECT DISTINCT c.numero::text AS num\n        FROM cardapio AS c\n        WHERE  ( c.nome ILIKE '%' || '{{ $json.nome }}' || '%' or   c.palavras_chave  ILIKE '%' || '{{ $json.nome }}' || '%')\n          AND tipo  = '{{ $json.categoria }}'\n    )\n))\n   \n     union all \n SELECT\n    numero,\n    nome,\n    descricao,\n    tipo,\n    cardapio,\n    CASE \n        WHEN '{{ $json.tamanho }}' = 'grande' THEN preco_grande\n        WHEN '{{ $json.tamanho }}' = 'media'  THEN preco_media\n        ELSE preco_grande\n    END AS valor\nFROM busca_cardapio((\n    SELECT string_agg(num, ', ')\n    FROM (\n        SELECT DISTINCT c.numero::text AS num\n        FROM cardapio AS c\n        WHERE ( c.nome ILIKE '%' || '{{ $json.nome }}' || '%' or   c.palavras_chave  ILIKE '%' || '{{ $json.nome }}' || '%')\n          AND  categoria  = 'borda'\n    )\n))\n   \n   ;","options":{}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[-1424,192],"id":"6c6f42cd-398b-4a85-8cc0-749916f25d10","name":"ConsultaBorda2","alwaysOutputData":true,"credentials":{"postgres":{"id":"3NLaVyXonSrCcLE3","name":"Postgres account"}}},{"parameters":{"fieldToSplitOut":"output.pizzas_fracionadas","options":{}},"type":"n8n-nodes-base.splitOut","typeVersion":1,"position":[-1856,416],"id":"f2e15827-3325-46b4-af66-6d79a2feca68","name":"item2","notes":"TEMPLATE DESENVOLVIDO POR NOCODE STARTUP\nhttps://nocodestartup.io/\n\nFORMA√á√ÉO GESTOR DE AGENTES DE IA:\nhttps://nocodestartup.io/formacao-gestor-agentes-ia/"},{"parameters":{"tableId":"item_pedido_temp","fieldsUi":{"fieldValues":[{"fieldId":"user_id","fieldValue":"71"},{"fieldId":"quantidade","fieldValue":"={{ $json.quantidade }}"},{"fieldId":"tipo","fieldValue":"salgado"},{"fieldId":"categoria","fieldValue":"pizza"},{"fieldId":"nome","fieldValue":"={{ $json.metade1 }}"},{"fieldId":"fracionada","fieldValue":"=true"},{"fieldId":"pedido_id","fieldValue":"=15"},{"fieldId":"tamanho","fieldValue":"=grande"},{"fieldId":"volume","fieldValue":"=''"}]}},"type":"n8n-nodes-base.supabase","typeVersion":1,"position":[-1632,416],"id":"0b510bdc-5997-4cf5-8d6c-2c09b0364df7","name":"Item2","credentials":{"supabaseApi":{"id":"CcvRddDPb5xelxfb","name":"Supabase account"}}},{"parameters":{"tableId":"item_pedido_temp","fieldsUi":{"fieldValues":[{"fieldId":"user_id","fieldValue":"71"},{"fieldId":"quantidade","fieldValue":"={{ $json.quantidade }}"},{"fieldId":"tipo","fieldValue":"salgado"},{"fieldId":"categoria","fieldValue":"pizza"},{"fieldId":"nome","fieldValue":"={{ $json.metade1 }}"},{"fieldId":"fracionada","fieldValue":"=true"},{"fieldId":"pedido_id","fieldValue":"=15"},{"fieldId":"tamanho","fieldValue":"=grande"},{"fieldId":"volume","fieldValue":"''"},{"fieldId":"nome_fracao","fieldValue":"={{ $json.metade2 }}"},{"fieldId":"numero","fieldValue":"0"}]}},"type":"n8n-nodes-base.supabase","typeVersion":1,"position":[384,-256],"id":"70f432d2-6fec-4034-969d-0644d4e9ffe3","name":"Item3","credentials":{"supabaseApi":{"id":"CcvRddDPb5xelxfb","name":"Supabase account"}}},{"parameters":{"fieldToSplitOut":"output.pizzas_fracionadas","options":{}},"type":"n8n-nodes-base.splitOut","typeVersion":1,"position":[144,-256],"id":"f4396305-4353-4e07-a1c9-56d70b325135","name":"item3","alwaysOutputData":false,"notes":"TEMPLATE DESENVOLVIDO POR NOCODE STARTUP\nhttps://nocodestartup.io/\n\nFORMA√á√ÉO GESTOR DE AGENTES DE IA:\nhttps://nocodestartup.io/formacao-gestor-agentes-ia/"},{"parameters":{"tableId":"item_pedido_temp","fieldsUi":{"fieldValues":[{"fieldId":"user_id","fieldValue":"71"},{"fieldId":"quantidade","fieldValue":"={{ $json.quantidade }}"},{"fieldId":"tipo","fieldValue":"salgado"},{"fieldId":"categoria","fieldValue":"={{ $json.categoria }}"},{"fieldId":"nome","fieldValue":"= {{ $('Loop Over Items1').item.json.nome }}"},{"fieldId":"fracionada","fieldValue":"=false"},{"fieldId":"pedido_id","fieldValue":"=15"},{"fieldId":"tamanho","fieldValue":"={{ $json.tamanho }}"},{"fieldId":"volume","fieldValue":"={{ $json.volume }}"},{"fieldId":"numero","fieldValue":"={{ $json.numero }}"}]}},"type":"n8n-nodes-base.supabase","typeVersion":1,"position":[608,-496],"id":"00e98834-958d-4902-a777-af1ba30d0da3","name":"Item1","credentials":{"supabaseApi":{"id":"CcvRddDPb5xelxfb","name":"Supabase account"}}},{"parameters":{"options":{}},"type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[320,-576],"id":"55639d94-3d1d-458b-b68d-fb2b4703522f","name":"Loop Over Items1"},{"parameters":{"fieldToSplitOut":"output.item","options":{}},"type":"n8n-nodes-base.splitOut","typeVersion":1,"position":[112,-576],"id":"5b8f6980-5bf4-4066-a0a3-ab8d8603beda","name":"item1","notes":"TEMPLATE DESENVOLVIDO POR NOCODE STARTUP\nhttps://nocodestartup.io/\n\nFORMA√á√ÉO GESTOR DE AGENTES DE IA:\nhttps://nocodestartup.io/formacao-gestor-agentes-ia/"},{"parameters":{"promptType":"define","text":"=<mensagem_do_usuario>\n{{ $json.chatInput }}\n</mensagem_do_usuario>","hasOutputParser":true,"messages":{"messageValues":[{"message":"=Voc√™ √© um parser de pedidos de pizzaria.\nResponda somente com um JSON v√°lido que siga exatamente o schema configurado (structured output).\nNunca escreva texto extra, coment√°rios, blocos de c√≥digo ou chaves diferentes das previstas.\n\nRegras obrigat√≥rias e defaults:\n\nSempre retorne os 2 blocos: \"item\" e \"pizzas_fracionadas\", mesmo que vazios ([]).\n\nSempre inclua todos os campos obrigat√≥rios de cada item.\n\nSe n√£o houver valor, use os defaults:\n\nStrings: \"\"\n\nN√∫meros: 0\n\nquantidade: 1\n\ntamanho (pizza/esfirra inteiras): \"media\" (sen√£o \"\")\n\nfracionada: \"nao\"\n\ntipo (pizza/esfirra inteiras): \"inteira\"\n\ncategoria default: \"pizza\"\n\nnumero: 0\n\nnumero_fracao: 0\n\nnome, nome_fracao, volume, pizza_referencia: \"\"\n\nvalor: 0\n\nid_pizza_pai: 0\n\nInterpreta√ß√£o:\n\nS√≥ trate como pizza se a palavra ‚Äúpizza‚Äù aparecer; idem esfirra.\n\n‚Äúuma/duas/tr√™s‚Ä¶‚Äù definem quantidade.\n\n‚Äúmeia‚Äù ‚â° ‚Äú1/2‚Äù.\n\n‚Äúpizza N‚Äù (sem sabor): gere pizza inteira com numero=N, tamanho=\"media\".\n\nFracionadas:\n\nSempre um √∫nico objeto em pizzas_fracionadas.\n\nPreencha: metade1 e metade2 (por nome ou n√∫mero conforme aparecer).\n\nMarque fracionada=\"sim\" e tipo=\"fracionada\".\n\nTamanho de fracionada √© sempre \"grande\".\n\nUse uma pizza_referencia (ex.: \"ref_123\") para vincular bordas.\n\nSe o usu√°rio disser ‚Äúpizza N‚Äù, esse valor vai em numero; se disser sabor por nome, use nome.\nnumero_fracao/nome_fracao n√£o s√£o usados em pizzas_fracionadas (use metade1/metade2).\n\nBordas:\n\n‚Äúborda X‚Äù ‚Üí categoria=\"borda\", nome=\"x\" (min√∫sculo).\n\nVincule por pizza_referencia (ou id_pizza_pai se citado).\n\nDefaults de borda: numero=0, tamanho=\"\", valor=0.\n\nBebidas:\n\n‚Äúlata‚Äù ‚Üí volume=\"350ml\".\n\n‚Äúlong neck‚Äù ‚Üí volume=\"330ml\".\n\n‚Äúcoca/coca-cola‚Äù sem volume ‚Üí volume=\"2l\".\n\nNormalize volume min√∫sculo e sem espa√ßos.\n\nEsfirras: categoria=\"esfirra\"; tipo pode ser \"salgada\"/\"doce\" ou \"\" se n√£o informado.\n\nNunca invente valores fora dos enums previstos pelo schema.\nA resposta deve ser apenas o JSON raiz com item e pizzas_fracionadas."}]}},"type":"@n8n/n8n-nodes-langchain.chainLlm","typeVersion":1.6,"position":[-224,-528],"id":"ad27a31b-64c1-4f95-af72-6ba702274b0e","name":"Basic LLM Chain","retryOnFail":true,"notes":"TEMPLATE DESENVOLVIDO POR NOCODE STARTUP\nhttps://nocodestartup.io/\n\nFORMA√á√ÉO GESTOR DE AGENTES DE IA:\nhttps://nocodestartup.io/formacao-gestor-agentes-ia/"},{"parameters":{"model":{"__rl":true,"value":"gpt-4.1-mini","mode":"list","cachedResultName":"gpt-4.1-mini"},"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[-224,-352],"id":"5d5e4d28-e16e-46dd-83f3-93faa900b2c3","name":"OpenAI Chat Model","credentials":{"openAiApi":{"id":"YvUoOPijIpNeTjed","name":"OpenAi account"}}},{"parameters":{},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[1008,-576],"id":"52225b2b-d0eb-4af6-8c95-52a816617494","name":"Merge"},{"parameters":{"operation":"executeQuery","query":"SELECT AtualizaValorFracionado( {{ $json.user_id }} , {{ $json.pedido_id }} );","options":{}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[656,-256],"id":"9c7a58f8-cca1-49f5-989b-4c0ff66a49af","name":"AtualizaValorPizzaFracionada","credentials":{"postgres":{"id":"3NLaVyXonSrCcLE3","name":"Postgres account"}}},{"parameters":{"operation":"executeQuery","query":"SELECT atualizar_valores_itens_temp( {{ $json.user_id }}, {{ $json.pedido_id }});","options":{}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[768,-592],"id":"559a4bd5-f9e7-4f2c-a325-0f9618563ec5","name":"AtualizaValorItem","credentials":{"postgres":{"id":"3NLaVyXonSrCcLE3","name":"Postgres account"}}},{"parameters":{"schemaType":"manual","inputSchema":" {\n  \"type\": \"object\",\n  \"properties\": {\n    \"item\": {\n      \"type\": \"array\",\n      \"items\": {\n        \"type\": \"object\",\n        \"additionalProperties\": false,\n        \"properties\": {\n          \"numero\": { \"type\": \"integer\", \"minimum\": 0 },\n          \"quantidade\": { \"type\": \"integer\", \"minimum\": 1 },\n          \"tamanho\": { \"type\": \"string\", \"enum\": [\"media\", \"grande\", \"\"] },\n          \"fracionada\": { \"type\": \"string\", \"enum\": [\"sim\", \"nao\", \"true\", \"false\", \"\"] },\n          \"tipo\": { \"type\": \"string\", \"enum\": [\"inteira\", \"fracionada\", \"salgada\", \"doce\", \"\"] },\n          \"categoria\": { \"type\": \"string\", \"enum\": [\"pizza\", \"esfirra\", \"bebida\", \"borda\", \"\"] },\n          \"numero_fracao\": { \"type\": \"integer\", \"minimum\": 0 },\n          \"nome\": { \"type\": \"string\" },\n          \"nome_fracao\": { \"type\": \"string\" },\n          \"volume\": { \"type\": \"string\" },\n          \"valor\": { \"type\": \"number\", \"minimum\": 0 },\n          \"pizza_referencia\": { \"type\": \"string\" },\n          \"id_pizza_pai\": { \"type\": \"integer\", \"minimum\": 0 }\n        },\n        \"required\": [\n          \"numero\",\n          \"quantidade\",\n          \"tamanho\",\n          \"fracionada\",\n          \"tipo\",\n          \"categoria\",\n          \"numero_fracao\",\n          \"nome\",\n          \"nome_fracao\",\n          \"volume\",\n          \"valor\",\n          \"pizza_referencia\",\n          \"id_pizza_pai\"\n        ]\n      }\n    },\n    \"pizzas_fracionadas\": {\n      \"type\": \"array\",\n      \"items\": {\n        \"type\": \"object\",\n        \"additionalProperties\": false,\n        \"properties\": {\n          \"numero\": { \"type\": \"integer\", \"minimum\": 0 },\n          \"quantidade\": { \"type\": \"integer\", \"minimum\": 1 },\n          \"tamanho\": { \"type\": \"string\", \"enum\": [\"grande\"] },\n          \"fracionada\": { \"type\": \"string\", \"enum\": [\"sim\"] },\n          \"tipo\": { \"type\": \"string\", \"enum\": [\"fracionada\"] },\n          \"categoria\": { \"type\": \"string\", \"enum\": [\"pizza\"] },\n          \"metade1\": { \"type\": \"string\" },\n          \"metade2\": { \"type\": \"string\" },\n          \"valor\": { \"type\": \"number\", \"minimum\": 0 },\n          \"pizza_referencia\": { \"type\": \"string\" },\n          \"id_pizza_pai\": { \"type\": \"integer\", \"minimum\": 0 }\n        },\n        \"required\": [\n          \"numero\",\n          \"quantidade\",\n          \"tamanho\",\n          \"fracionada\",\n          \"tipo\",\n          \"categoria\",\n          \"metade1\",\n          \"metade2\",\n          \"valor\",\n          \"pizza_referencia\",\n          \"id_pizza_pai\"\n        ]\n      }\n    }\n  },\n  \"required\": [\"item\", \"pizzas_fracionadas\"],\n  \"additionalProperties\": false\n}\n"},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.2,"position":[-80,-336],"id":"7c710397-c231-4452-bc2f-22f1d54ffe62","name":"Structured Output Parser [Schema]","notes":"TEMPLATE DESENVOLVIDO POR NOCODE STARTUP\nhttps://nocodestartup.io/\n\nFORMA√á√ÉO GESTOR DE AGENTES DE IA:\nhttps://nocodestartup.io/formacao-gestor-agentes-ia/"}],"connections":{"When chat message received":{"main":[[{"node":"Basic LLM Chain","type":"main","index":0}]]},"OpenAI Chat Model4":{"ai_languageModel":[[{"node":"Basic LLM Chain1","type":"ai_languageModel","index":0}]]},"Structured Output Parser [Schema]1":{"ai_outputParser":[[{"node":"Basic LLM Chain1","type":"ai_outputParser","index":0}]]},"Basic LLM Chain1":{"main":[[{"node":"item","type":"main","index":0},{"node":"item2","type":"main","index":0}]]},"item":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"Loop Over Items":{"main":[[{"node":"Replace Me","type":"main","index":0}],[{"node":"ConsultaBorda2","type":"main","index":0}]]},"Replace Me":{"main":[[]]},"Item":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"If":{"main":[[{"node":"Item","type":"main","index":0}],[{"node":"Loop Over Items","type":"main","index":0}]]},"ConsultaBorda2":{"main":[[{"node":"If","type":"main","index":0}]]},"item2":{"main":[[{"node":"Item2","type":"main","index":0}]]},"item3":{"main":[[{"node":"Item3","type":"main","index":0}]]},"Item1":{"main":[[{"node":"Loop Over Items1","type":"main","index":0}]]},"Loop Over Items1":{"main":[[{"node":"AtualizaValorItem","type":"main","index":0}],[{"node":"Item1","type":"main","index":0}]]},"item1":{"main":[[{"node":"Loop Over Items1","type":"main","index":0}]]},"Basic LLM Chain":{"main":[[{"node":"item3","type":"main","index":0},{"node":"item1","type":"main","index":0}]]},"OpenAI Chat Model":{"ai_languageModel":[[{"node":"Basic LLM Chain","type":"ai_languageModel","index":0}]]},"Item3":{"main":[[{"node":"AtualizaValorPizzaFracionada","type":"main","index":0}]]},"AtualizaValorPizzaFracionada":{"main":[[{"node":"Merge","type":"main","index":1}]]},"AtualizaValorItem":{"main":[[{"node":"Merge","type":"main","index":0}]]},"Structured Output Parser [Schema]":{"ai_outputParser":[[{"node":"Basic LLM Chain","type":"ai_outputParser","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":null,"pinData":{},"versionId":"99abced6-fc00-40db-b660-96c1cb77eb2f","triggerCount":0,"shared":[{"createdAt":"2025-09-18T15:44:58.320Z","updatedAt":"2025-09-18T15:44:58.320Z","role":"workflow:owner","workflowId":"gL1FbKkYm9zGfCAA","projectId":"wFRMrac2003Pl1x6"}],"tags":[]}