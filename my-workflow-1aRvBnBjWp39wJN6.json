{"createdAt":"2025-08-20T01:29:13.281Z","updatedAt":"2025-08-20T02:43:17.153Z","id":"1aRvBnBjWp39wJN6","name":"My workflow","active":false,"isArchived":false,"nodes":[{"parameters":{"url":"=https://r.jina.ai/https://massasdonaivone.menudino.com/","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[-16,784],"id":"be983a38-4dce-42f3-b757-a1271edd9b2d","name":"HTTP Request"},{"parameters":{"modelId":{"__rl":true,"value":"gpt-4o","mode":"list","cachedResultName":"GPT-4O"},"messages":{"values":[{"content":"Você receber uma lista de livros e responder um JSON com os campaos book_name, book_author , book_price","role":"system"},{"content":"=  {{ $json.data }}\n"}]},"simplify":false,"jsonOutput":true,"options":{}},"type":"@n8n/n8n-nodes-langchain.openAi","typeVersion":1.8,"position":[-400,128],"id":"0133aef7-e5d7-4bbd-ab8c-80ebd5056074","name":"OpenAI","disabled":true},{"parameters":{"assignments":{"assignments":[{"id":"7a47cae1-cfd1-45ab-9557-f0f4814c5d80","name":"choices[0].message.content.lista_imoveis","value":"={{ $json.choices[0].message.content.lista_imoveis }}","type":"array"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[608,784],"id":"be74bd13-8932-4fe1-883c-f5633ba1c7ee","name":"Edit Fields"},{"parameters":{"fieldToSplitOut":"choices[0].message.content.lista_imoveis","options":{}},"type":"n8n-nodes-base.splitOut","typeVersion":1,"position":[784,784],"id":"b705dd75-1351-4d64-bf5a-329adf11d3fb","name":"Split Out"},{"parameters":{"options":{}},"type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[272,240],"id":"5e42c70c-26b3-4f9c-a8a0-2d7986be4921","name":"Loop Over Items","disabled":true},{"parameters":{},"type":"n8n-nodes-base.noOp","name":"Replace Me","typeVersion":1,"position":[512,112],"id":"a1f50de3-43e4-4ee7-b145-7f099066cd25"},{"parameters":{"tableId":"livros","fieldsUi":{"fieldValues":[{"fieldId":"name","fieldValue":"={{ $json.book_name }}"},{"fieldId":"author","fieldValue":"={{ $json.book_author }}"},{"fieldId":"price","fieldValue":"={{ $json.book_price }}"}]}},"type":"n8n-nodes-base.supabase","typeVersion":1,"position":[592,272],"id":"dd23a389-69a5-4d89-9828-8555d1416414","name":"Supabase"},{"parameters":{"options":{}},"type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[1040,784],"id":"22dfb04f-48e2-4e33-b7d7-c42bbdf3339c","name":"Loop Over Items1"},{"parameters":{},"type":"n8n-nodes-base.noOp","name":"Replace Me1","typeVersion":1,"position":[1424,544],"id":"c28ed64b-5980-4e79-9968-6cfb26e5a934"},{"parameters":{"tableId":"Leilao","fieldsUi":{"fieldValues":[{"fieldId":"descricao","fieldValue":"={{ $json.apartamento }}"},{"fieldId":"link","fieldValue":"={{ $json.link }}"},{"fieldId":"praca_1_data","fieldValue":"={{ $json.praca_1_data }}"},{"fieldId":"praca_1_valor","fieldValue":"={{ $json.praca_1_valor }}"},{"fieldId":"praca_2_data","fieldValue":"={{ $json.praca_2_data }}"},{"fieldId":"praca_2_valor","fieldValue":"={{ $json.praca_2_valor }}"},{"fieldId":"desconto","fieldValue":"={{ $json.desconto }}"},{"fieldId":"origem","fieldValue":"MEGA"}]}},"type":"n8n-nodes-base.supabase","typeVersion":1,"position":[1344,800],"id":"45e43441-6e7b-4ddb-beea-5e79f4f93a21","name":"Supabase1"},{"parameters":{"assignments":{"assignments":[{"id":"dc19648c-e49f-4e7a-90d6-204b894727f7","name":"endereco_leilao","value":"https://www.megaleiloes.com.br/imoveis/apartamentos/sp/sao-paulo?tov=igbr&valor_max=5000000&tipo%5B0%5D=1&tipo%5B1%5D=2","type":"string"},{"id":"247e46d5-7232-48cd-84e2-e87e3931335c","name":"Estado","value":"São Paulo","type":"string"},{"id":"15199d6a-0915-47f9-91c4-30e63c8d0269","name":"Cidade","value":"São Paulo","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-288,784],"id":"c61ad17e-2047-411b-954d-15f1688f2be5","name":"Edit Fields1"},{"parameters":{},"type":"n8n-nodes-base.manualTrigger","typeVersion":1,"position":[-544,784],"id":"1e6bb3fa-3670-439a-8a24-8d1179726812","name":"When clicking ‘Execute workflow’"},{"parameters":{"promptType":"define","text":"Seja gentil com usuario ","options":{"systemMessage":" para esse site de imoveis https://www.megaleiloes.com.br/ quero que gere uma consulta valida que procurre imoveis apartamentos no estado de são paulo e cidade de ribeirão preto"}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":2,"position":[0,0],"id":"8b0a9b38-9871-4f12-8943-3ad9249696e5","name":"AI Agent"},{"parameters":{"model":{"__rl":true,"mode":"list","value":"gpt-4o-mini"},"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[-16,192],"id":"db15bdf5-e3cf-4c67-bdfe-7962d0e11eb6","name":"OpenAI Chat Model"},{"parameters":{"sessionIdType":"customKey","sessionKey":"21111"},"type":"@n8n/n8n-nodes-langchain.memoryBufferWindow","typeVersion":1.3,"position":[112,160],"id":"3e3842e6-d5fa-406c-b0a8-07cc122e89a1","name":"Simple Memory"},{"parameters":{"modelId":{"__rl":true,"value":"gpt-4o-mini","mode":"list","cachedResultName":"GPT-4O-MINI"},"messages":{"values":[{"content":"  Você é um extrator de dados de leilões do site Mega Leilões.\n\nReceberá abaixo o conteúdo bruto (texto ou HTML) de uma página de imóveis. Sua tarefa é extrair **TODOS os imóveis listados** cujo link contenha o padrão:\n\nhttps://www.megaleiloes.com.br/imoveis/apartamentos/sp/sao-paulo/apartamento*\n\nPara cada imóvel, extraia os seguintes campos e organize como um array JSON sob a chave `lista_imoveis`:\n\n- \"apartamento\": título ou tipo do imóvel\n- \"link\": URL completa para o imóvel\n- \"praca_1_data\": data e horário da 1ª Praça (ex: \"05/06/2025 às 15:30\")\n- \"praca_1_valor\": valor da 1ª Praça (ex: \"R$ 1.465.532,11\")\n- \"praca_2_data\": data e horário da 2ª Praça (se disponível)\n- \"praca_2_valor\": valor da 2ª Praça (se disponível)\n- \"desconto\": valor ou percentual de desconto (se existir)\n\nFormato de saída esperado:\n\n```json\n{\n  \"lista_imoveis\": [\n    {\n      \"apartamento\": \"...\",\n      \"link\": \"...\",\n      \"praca_1_data\": \"...\",\n      \"praca_1_valor\": \"...\",\n      \"praca_2_data\": \"...\",\n      \"praca_2_valor\": \"...\",\n      \"desconto\": \"...\"\n    },\n    ...\n  ]\n}\n","role":"system"},{"content":"=  {{ $json.data }}\n"}]},"simplify":false,"jsonOutput":true,"options":{}},"type":"@n8n/n8n-nodes-langchain.openAi","typeVersion":1.8,"position":[272,784],"id":"06123018-37a2-4a76-9263-480c72f6a19d","name":"Message a model","credentials":{"openAiApi":{"id":"2hW4LOItQwhgTw0Q","name":"OpenAi account"}}}],"connections":{"HTTP Request":{"main":[[{"node":"Message a model","type":"main","index":0}]]},"Edit Fields":{"main":[[{"node":"Split Out","type":"main","index":0}]]},"Split Out":{"main":[[{"node":"Loop Over Items1","type":"main","index":0}]]},"Loop Over Items":{"main":[[{"node":"Replace Me","type":"main","index":0}],[{"node":"Supabase","type":"main","index":0}]]},"Supabase":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"Loop Over Items1":{"main":[[{"node":"Replace Me1","type":"main","index":0}],[{"node":"Supabase1","type":"main","index":0}]]},"Supabase1":{"main":[[{"node":"Loop Over Items1","type":"main","index":0}]]},"Edit Fields1":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]},"When clicking ‘Execute workflow’":{"main":[[{"node":"Edit Fields1","type":"main","index":0}]]},"OpenAI Chat Model":{"ai_languageModel":[[{"node":"AI Agent","type":"ai_languageModel","index":0}]]},"Simple Memory":{"ai_memory":[[{"node":"AI Agent","type":"ai_memory","index":0}]]},"Message a model":{"main":[[{"node":"Edit Fields","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":null,"pinData":{},"versionId":"d886e195-6108-45c7-b845-eb9e26183811","triggerCount":0,"tags":[]}