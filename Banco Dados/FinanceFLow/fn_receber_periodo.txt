CREATE OR REPLACE FUNCTION fn_receber_periodo(
  p_empresa_id BIGINT,
  p_inicio DATE,
  p_fim DATE
)
RETURNS NUMERIC
LANGUAGE sql
AS $$
  SELECT COALESCE(SUM(valor),0)
  FROM contas_a_receber
  WHERE
    empresa_id = p_empresa_id
    AND status = 'aberto'
    AND vencimento BETWEEN p_inicio AND p_fim;
$$;
