CREATE OR REPLACE FUNCTION contab.ff_diario_processar(
    p_empresa_id int,
    p_diario_id  bigint
)
RETURNS void AS
$$
BEGIN
    UPDATE contab.diario
       SET status = 'processado'
     WHERE id = p_diario_id
       AND empresa_id = p_empresa_id
       AND status IN ('rascunho', 'confirmado');

    IF NOT FOUND THEN
        RAISE EXCEPTION 'Lan칞amento n칚o encontrado ou j치 est치 processado/estornado.';
    END IF;

    -- 游댚 aqui depois voc칡 coloca a l칩gica que gera os lan칞amentos cont치beis
END;
$$ LANGUAGE plpgsql;
