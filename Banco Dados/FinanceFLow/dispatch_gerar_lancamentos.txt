CREATE OR REPLACE FUNCTION contab.dispatch_gerar_lancamentos(
    p_diario_id  BIGINT,
    p_empresa_id BIGINT,
    p_modelo_codigo TEXT
)
RETURNS VOID
LANGUAGE plpgsql
AS $$
BEGIN
    ------------------------------------------------------------------
    -- ESTORNOS
    ------------------------------------------------------------------
    IF p_modelo_codigo = 'ESTORNO' THEN
        PERFORM contab.gerar_lancamentos_estorno_generico(p_diario_id, p_empresa_id);
        RETURN;
    END IF;

    IF p_modelo_codigo LIKE 'ESTORNO_%' THEN
        PERFORM contab.gerar_lancamentos_estorno(p_diario_id, p_empresa_id);
        RETURN;
    END IF;

    ------------------------------------------------------------------
    -- FINANCEIRO ESPECÍFICO
    ------------------------------------------------------------------
    IF p_modelo_codigo IN ('PAGAR','RECEBER') THEN
        PERFORM contab.gerar_lancamentos_pagar_receber(p_diario_id, p_empresa_id);
        RETURN;
    END IF;

    IF p_modelo_codigo = 'COMPRA_CARTAO' THEN
        PERFORM contab.ff_gerar_lancamento_compra_cartao(p_diario_id, p_empresa_id);
        RETURN;
    END IF;

    IF p_modelo_codigo = 'PAGAMENTO_FATURA_CARTAO' THEN
        PERFORM contab.ff_gerar_lancamento_pagto_fatura_cartao(p_diario_id, p_empresa_id);
        RETURN;
    END IF;

    ------------------------------------------------------------------
    -- PADRÃO (MODELOS COMUNS / À VISTA / CATEGORIA)
    ------------------------------------------------------------------
    PERFORM contab.gerar_lancamentos_por_diario(p_diario_id, p_empresa_id);

END;
$$;
